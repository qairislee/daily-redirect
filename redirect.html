<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Daily Redirect</title>
</head>
<body>
  <p>ğŸ”„ æ­£åœ¨ç‚ºæ‚¨å°‹æ‰¾ä»Šå¤©çš„ Daily Standup é é¢...</p>

  <script>
(async () => {
  // æ¯é çš„ Confluence pageIdï¼ˆä½ å¯ä»¥ç¡¬å¯«æ­»ï¼Œä¹Ÿå¯ä»¥å¾ meta è£¡å‹•æ…‹å–ï¼‰
  const parentPageId = '609911659'; // æ›¿æ›ç‚ºä½  Daily Standup ä¸»é çš„ pageId

  try {
    const response = await fetch(`/wiki/rest/api/content/${parentPageId}/child/page?limit=100`, {
      headers: {
        'Accept': 'application/json'
      },
      credentials: 'include'  // é‡è¦ï¼šéœ€è¦å¸¶ä¸Š cookie åŸ·è¡Œ
    });

    const data = await response.json();
    const children = data.results;

    // å–å¾—ä»Šå¤©æ—¥æœŸï¼Œæ ¼å¼: "4/10"
    const today = new Date();
    const todayStr = `${today.getMonth() + 1}/${today.getDate()}`;

    // æ‰¾åŒ…å«ä»Šå¤©æ—¥æœŸçš„é é¢
    const todayPage = children.find(p => p.title.includes(todayStr));

    if (todayPage) {
      // æˆåŠŸï¼šè·³è½‰è‡³ Confluence é é¢
      const url = `/wiki${todayPage._links.webui}`;
      console.log("Redirecting to:", url);
      window.location.href = url;
    } else {
      document.body.innerHTML = `<h2>âŒ æ‰¾ä¸åˆ°ä»Šå¤© (${todayStr}) çš„ Daily é é¢</h2>`;
    }
  } catch (err) {
    console.error("ç™¼ç”ŸéŒ¯èª¤ï¼š", err);
    document.body.innerHTML = `<h2>ğŸš¨ è«‹ç™»å…¥ Confluence å¾Œé‡æ•´é é¢</h2>`;
  }
})();
</script>
</body>
</html>
